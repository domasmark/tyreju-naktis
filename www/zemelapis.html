<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map-canvas { height: 100% }
    </style>
    <script type="text/javascript"
      src="js/googlemaps.js">
    </script>
    <script type="text/javascript">
      function initialize() {
		navigator.geolocation.getCurrentPosition(onSuccess, onError);
      }
      google.maps.event.addDomListener(window, 'load', initialize);
	var onSuccess = function(position) {
		//navigator.notification.alert('geolocation received', function(){});
		//alert('Latitude: '          + position.coords.latitude          + '\n' +
		//	  'Longitude: '         + position.coords.longitude         + '\n' +
		//	  'Altitude: '          + position.coords.altitude          + '\n' +
		//	  'Accuracy: '          + position.coords.accuracy          + '\n' +
		//	  'Altitude Accuracy: ' + position.coords.altitudeAccuracy  + '\n' +
		//	  'Heading: '           + position.coords.heading           + '\n' +
		//	  'Speed: '             + position.coords.speed             + '\n' +
		//	  'Timestamp: '         + position.timestamp                + '\n');
			  var mapOptions = {
			  center : new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
			  zoom: 14,
			  mapTypeId: google.maps.MapTypeId.ROADMAP
			  };
			  var map = new google.maps.Map(document.getElementById("map-canvas"),
				mapOptions);
			var marker = new google.maps.Marker({
				position: mapOptions.center,
				map: map,
				title:"Your position",
				clickable: true,
				icon: { path: google.maps.SymbolPath.BACKWARD_CLOSED_ARROW, scale:6 }
				
			});
			google.maps.event.addListener(marker, 'click', function (){
				window.location.replace('http://www.google.com');
			
			
			});
			map.set('styles', [
				{
					featureType: 'road',
					elementType: 'geometry',
					stylers: [
						{ color: '#ffffff' }, {weight: 1.0}
					]
				}, {
					featureType: 'road',
					elementType: 'labels',
					stylers: [
						{ color: '#000055' }, {weight: 0.2}
					]
				}, {
					featureType: 'poi',
					elementType: 'labels',
					stylers: [
						{ visibility: 'off' }
					]
				}, {
					featureType: 'road.highway',
					elementType: 'labels',
					stylers: [
						{ visibility: 'off' }
					]
				}, {
					featureType: 'poi',
					elementType: 'geometry',
					stylers: [
						{ visibility: 'off' }
					]
				}
				
				]);
	};

	// onError Callback receives a PositionError object
	//
	function onError(error) {
		//if (PositionError.PERMISSION_DENIED == error.code)
			//alert('geolocation permission not granted');
			//navigator.notification.alert('geolocation permission not granted', function(){});
		//if (PositionError.POSITION_UNAVAILABLE == error.code)
			//alert('geolocation not available');
			//navigator.notification.alert('geolocation not available', function(){});
		//if (PositionError.TIMEOUT = error.code)
			//alert('geolocation timeout');
			//navigator.notification.alert('geolocation timeout', function(){});
	}
	
	

	</script>
	
  </head>
  <body onload="loadCodes()">
	<div><form action="" method="GET" onsubmit="return enterCode()" name="codeInputForm">
	Kodas: <input type="text" name="code">
	<input type="submit" value="Įvesti">
	</form> </div>
	<div id="enteredCodes"></div>
	
	<script src="js/jquery.min.js"></script>
	<script type="text/javascript">
	function enterCode() {
		var code = document.forms["codeInputForm"]["code"].value;
		var availableCodes = new Array();
		availableCodes[0] = "labas";
		availableCodes[1] = "rytas";
		availableCodes[2] = "drauge";
		for (var i=0;i<availableCodes.length;i++)
		{ 
			if (code.toLowerCase() == availableCodes[i]) {
				//alert('code accepted', function(){});
				var db = window.localStorage;
				var numCodesUnlocked = parseInt(db.getItem("numCodesUnlocked"));
				if (isNaN(numCodesUnlocked)) {
					numCodesUnlocked = 0;
				}
				for (var j = 0; j < numCodesUnlocked; j++) {
					if (db.getItem("code"+j) == code.toLowerCase()) {
						return false;
					}
				}
				db.setItem("code"+numCodesUnlocked, code.toLowerCase());
				db.setItem("numCodesUnlocked", numCodesUnlocked+1);
				$('div#enteredCodes').append('<p>'+code+'</p>'); 
				return false;
			}
		}
		//alert('code failed', function(){});
		return false;
	};
	
	function loadCodes() {
		var db = window.localStorage;
		var numCodesUnlocked = parseInt(db.getItem("numCodesUnlocked"));
		console.log("total unlocked codes: "  + numCodesUnlocked);
		for (var j = 0; j < numCodesUnlocked; j++) {
			var code = db.getItem("code"+j);
			$('div#enteredCodes').append('<p>'+code+'</p>'); 
		}
	}
	</script>
    <div id="map-canvas"/>
  </body>
</html>